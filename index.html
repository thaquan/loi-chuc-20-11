<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lá»i ChÃºc Äáº·c Biá»‡t 20/11 ğŸ“š</title>
    <style>
        /* --- FONT & MÃ€U CHá»¦ Äáº O --- */
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Quicksand:wght@400;600&display=swap');

        :root {
            --primary: #ff6b35;
            --secondary: #4ecdc4;
            --light-bg: #f7f9fb;
            --deep-orange: #e55234;
            --green: #2ecc71;
            --text-color: #2c3e50;
        }

        /* --- Ná»€N & CÄ‚N GIá»®A --- */
        body {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #ffeaa7, #fab1a0, #74b9ff);
            overflow: hidden;
            color: var(--text-color);
        }

        /* --- KHUNG CHÃNH POP --- */
        .poppable {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            padding: 45px 55px;
            border-radius: 25px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            text-align: center;
            max-width: 500px;
            width: 90%;
            transform: scale(0.8);
            opacity: 0;
            animation: popIn 0.9s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes popIn {
            0% { transform: scale(0.5) rotate(-5deg); opacity: 0; }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }

        /* --- TIÃŠU Äá»€ Má»œI NHáº¬P --- */
        .prompt-container h2 {
            font-family: 'Great Vibes', cursive;
            font-size: 42px;
            color: var(--deep-orange);
            margin-bottom: 30px;
            animation: fadeIn 1s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Ã” NHáº¬P TÃŠN --- */
        .prompt-container input {
            width: 90%;
            padding: 15px 25px;
            font-size: 18px;
            border: 2px solid #ffd89b;
            border-radius: 50px;
            margin-bottom: 25px;
            font-weight: 600;
            text-align: center;
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .prompt-container input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 5px rgba(255, 107, 53, 0.15);
        }

        .prompt-container input::placeholder {
            color: #fdcb6e;
            font-style: italic;
        }

        /* --- NÃšT Báº¤M NÃ‚NG Cáº¤P --- */
        .prompt-container button {
            background: linear-gradient(135deg, var(--primary), var(--deep-orange));
            color: white;
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.35);
        }

        .prompt-container button:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 12px 30px rgba(255, 107, 53, 0.5);
        }

        /* --- NÃšT QUAY Láº I --- */
        .back-button {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.4s ease;
            box-shadow: 0 6px 15px rgba(108, 117, 125, 0.3);
        }

        .back-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(108, 117, 125, 0.4);
        }

        /* --- THáºº CHÃšC Má»ªNG --- */
        .card {
            display: none;
        }

        .card h1 {
            font-family: 'Great Vibes', cursive;
            font-size: 60px;
            color: var(--primary);
            margin-bottom: 10px;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px #ffd89b; }
            to { text-shadow: 0 0 20px #ff6b35, 0 0 30px #fdcb6e; }
        }

        .card .recipient-name {
            font-size: 26px;
            font-weight: 600;
            color: var(--deep-orange);
            margin-bottom: 25px;
        }

        .card .recipient-name span {
            color: var(--primary);
            font-style: italic;
        }

        .card .message {
            font-size: 18px;
            line-height: 1.8;
            color: #555;
            background: #fffbf0;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.05);
            animation: fadeIn 1s ease forwards;
        }

        /* --- ICON RÆ I --- */
        .icon-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .falling-icon {
            position: absolute;
            top: -50px;
            font-size: 24px;
            opacity: 0.8;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(105vh) rotate(360deg);
                opacity: 0.4;
            }
        }

        /* --- HIá»†U á»¨NG CHá»® XUáº¤T HIá»†N --- */
        .fade-up {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeUp 1s ease forwards;
        }

        @keyframes fadeUp {
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div class="icon-container" id="icon-container"></div>

    <div class="poppable prompt-container" id="prompt-container">
        <h2>MÃ³n quÃ  20/11 ğŸ“–</h2>
        <input type="text" id="nameInput" placeholder="... Tháº§y/CÃ´ gÃµ tÃªn á»Ÿ Ä‘Ã¢y nha...">
        <button id="submitButton">Xem lá»i chÃºc dÃ nh riÃªng ğŸ“</button>
    </div>

    <div class="card poppable" id="main-card">
        <h1>ğŸ“š ChÃºc Má»«ng 20/11! ğŸ“š</h1>
        <p class="recipient-name fade-up">KÃ­nh gá»­i <span id="recipientName">...</span> ğŸŒŸ</p>
        <p class="message fade-up" id="wishMessage">
            <!-- Lá»i chÃºc sáº½ Ä‘Æ°á»£c random á»Ÿ Ä‘Ã¢y -->
        </p>
        <button class="back-button" id="backButton">Quay láº¡i ğŸ”„</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.getElementById('nameInput');
            const submitButton = document.getElementById('submitButton');
            const backButton = document.getElementById('backButton');
            const promptContainer = document.getElementById('prompt-container');
            const card = document.getElementById('main-card');
            const recipientName = document.getElementById('recipientName');
            const wishMessage = document.getElementById('wishMessage');
            const iconContainer = document.getElementById('icon-container');
            const icons = ['ğŸ“š', 'ğŸ“–', 'âœï¸', 'ğŸ“', 'ğŸ†', 'â­', 'ğŸŒŸ', 'ğŸ’', 'ğŸŒ¸'];

            // Danh sÃ¡ch tÃªn nam phá»• biáº¿n á»Ÿ Viá»‡t Nam
            const maleNames = [
                'hÃ¹ng', 'dÅ©ng', 'cÆ°á»ng', 'tuáº¥n', 'hiáº¿u', 'minh', 'hoÃ ng', 'khoa', 'quang', 'háº£i',
                'nam', 'thÃ nh', 'Ä‘á»©c', 'phong', 'long', 'sÆ¡n', 'tÃ¢m', 'bÃ¬nh', 'tháº¯ng', 'trung',
                'anh', 'viá»‡t', 'quÃ¢n', 'kiÃªn', 'vÅ©', 'tÃ¹ng', 'hÆ°ng', 'thá»‹nh', 'Ä‘áº¡t', 'phÃºc',
                'tÃ i', 'khang', 'phÃ¡t', 'nghÄ©a', 'trÃ­', 'toÃ n', 'thiá»‡n', 'lÃ¢m', 'huy', 'hÃ o',
                'linh', 'khÃ¡nh', 'tiáº¿n', 'thÃ¡i', 'phÆ°Æ¡ng', 'thanh', 'tÃ­n', 'nhÃ¢n', 'hiá»‡p', 'danh', 'cÆ°Æ¡ng', 'bÃ¡u', 'tÃ¹ng', 'duy'
            ];

            // Danh sÃ¡ch tÃªn ná»¯ phá»• biáº¿n á»Ÿ Viá»‡t Nam
            const femaleNames = [
                'hoa', 'lan', 'hÆ°Æ¡ng', 'tháº£o', 'loan', 'nga', 'oanh', 'trang', 'dung', 'háº±ng',
                'hÃ ', 'mai', 'huyá»n', 'linh', 'nhung', 'tuyáº¿t', 'thu', 'xuÃ¢n', 'yáº¿n', 'vÃ¢n',
                'thÃºy', 'diá»‡u', 'my', 'nhÆ°', 'phÆ°Æ¡ng', 'thanh', 'khanh', 'khÃ¡nh', 'trÃ¢m', 'vy',
                'quá»³nh', 'hiá»n', 'phÆ°á»£ng', 'ly', 'thÆ°', 'giang', 'trinh', 'tÃ¢m', 'ngá»c', 'chÃ¢u',
                'anh', 'bÃ­ch', 'cáº©m', 'diá»…m', 'háº¡nh', 'kim', 'lá»‡', 'minh', 'nhi', 'uyÃªn', 'kim', 'chi', 'thá»§y', 'trÃºc', 'thu', 'tiÃªn', 'ngÃ¢n', 'quá»³nh', 'lai'
            ];

            // HÃ m nháº­n diá»‡n giá»›i tÃ­nh tá»« tÃªn
            function detectGender(fullName) {
                const nameParts = fullName.toLowerCase().trim().split(' ');
                const lastName = nameParts[nameParts.length - 1]; // Láº¥y tÃªn (pháº§n cuá»‘i)
                
                // Kiá»ƒm tra tÃªn cÃ³ trong danh sÃ¡ch nam
                if (maleNames.includes(lastName)) {
                    return 'male';
                }
                
                // Kiá»ƒm tra tÃªn cÃ³ trong danh sÃ¡ch ná»¯
                if (femaleNames.includes(lastName)) {
                    return 'female';
                }
                
                // Máº·c Ä‘á»‹nh lÃ  tháº§y/cÃ´ náº¿u khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c
                return 'neutral';
            }

            // Lá»i chÃºc cho tháº§y giÃ¡o (nam)
            const maleWishes = [
                "NhÃ¢n ngÃ y NhÃ  giÃ¡o Viá»‡t Nam 20/11, em xin gá»­i Ä‘áº¿n tháº§y lá»i chÃºc sá»©c khá»e dá»“i dÃ o, háº¡nh phÃºc an lÃ nh. Cáº£m Æ¡n tháº§y Ä‘Ã£ luÃ´n táº­n tÃ¢m truyá»n Ä‘áº¡t kiáº¿n thá»©c vÃ  yÃªu thÆ°Æ¡ng há»c trÃ²! ğŸŒ¹âœ¨",
                
                "KÃ­nh chÃºc tháº§y ngÃ y 20/11 tháº­t nhiá»u niá»m vui vÃ  háº¡nh phÃºc! Nhá»¯ng bÃ i giáº£ng cá»§a tháº§y khÃ´ng chá»‰ lÃ  tri thá»©c mÃ  cÃ²n lÃ  nguá»“n cáº£m há»©ng cho em má»—i ngÃ y. Tháº§y mÃ£i lÃ  ngÆ°á»i tháº§y tuyá»‡t vá»i nháº¥t! ğŸ“šğŸ’–",
                
                "ChÃºc tháº§y luÃ´n trÃ n Ä‘áº§y nÄƒng lÆ°á»£ng, sá»©c khá»e dá»“i dÃ o vÃ  gáº·t hÃ¡i nhiá»u thÃ nh cÃ´ng trong sá»± nghiá»‡p cao quÃ½. Em biáº¿t Æ¡n vÃ¬ Ä‘Ã£ Ä‘Æ°á»£c lÃ m há»c trÃ² cá»§a tháº§y! ğŸ“ğŸŒŸ",
                
                "Gá»­i tháº§y ngÆ°á»i em kÃ­nh yÃªu, chÃºc má»«ng ngÃ y NhÃ  giÃ¡o Viá»‡t Nam! Cáº£m Æ¡n tháº§y Ä‘Ã£ dÃ nh cáº£ thanh xuÃ¢n Ä‘á»ƒ hun Ä‘Ãºc tri thá»©c vÃ  tÃ¢m há»“n cho tháº¿ há»‡ há»c trÃ². Tháº§y lÃ  niá»m tá»± hÃ o cá»§a chÃºng em! ğŸ†ğŸ’«",
                
                "NhÃ¢n dá»‹p 20/11, em chÃºc tháº§y luÃ´n vui váº», máº¡nh khá»e vÃ  thÃ nh cÃ´ng rá»±c rá»¡! Nhá»¯ng lá»i dáº¡y cá»§a tháº§y sáº½ mÃ£i lÃ  hÃ nh trang quÃ½ giÃ¡ trÃªn con Ä‘Æ°á»ng trÆ°á»Ÿng thÃ nh cá»§a em. YÃªu tháº§y nhiá»u láº¯m! ğŸ’ğŸŒˆ",
                
                "ChÃºc tháº§y má»™t ngÃ y 20/11 tháº­t Ã½ nghÄ©a! Tháº§y khÃ´ng chá»‰ lÃ  ngÆ°á»i tháº§y mÃ  cÃ²n lÃ  ngÆ°á»i báº¡n, ngÆ°á»i Ä‘á»‹nh hÆ°á»›ng cho cuá»™c Ä‘á»i em. Em sáº½ luÃ´n nhá»› Æ¡n vÃ  tá»± hÃ o vá» tháº§y! ğŸŒ¸âœ¨",
                
                "KÃ­nh gá»­i tháº§y, nhÃ¢n ngÃ y NhÃ  giÃ¡o Viá»‡t Nam, em chÃºc tháº§y luÃ´n tÆ°Æ¡i tráº», háº¡nh phÃºc vÃ  thÃ nh Ä‘áº¡t! Cáº£m Æ¡n tháº§y Ä‘Ã£ luÃ´n kiÃªn nháº«n, táº­n tÃ¬nh vÃ  yÃªu thÆ°Æ¡ng chÃºng em! ğŸŠğŸ’",
                
                "20/11 - ngÃ y Ä‘á»ƒ em Ä‘Æ°á»£c bÃ y tá» lÃ²ng biáº¿t Æ¡n sÃ¢u sáº¯c Ä‘áº¿n tháº§y. ChÃºc tháº§y sá»©c khá»e, bÃ¬nh an vÃ  luÃ´n lÃ  ngá»n Ä‘Ã¨n soi Ä‘Æ°á»ng cho biáº¿t bao tháº¿ há»‡ há»c trÃ²! ğŸ•¯ï¸ğŸŒŸ",

                "Tháº§y Æ¡i, ngÃ y 20/11 nÃ y em chÃºc tháº§y luÃ´n tÆ°Æ¡i tráº» nhÆ° ngÃ y nÃ o, nhiá»‡t huyáº¿t vá»›i nghá» vÃ  háº¡nh phÃºc bÃªn gia Ä‘Ã¬nh. Cáº£m Æ¡n tháº§y Ä‘Ã£ lÃ  Ã¡nh sÃ¡ng dáº«n Ä‘Æ°á»ng cho chÃºng em! ğŸŒºğŸ’•",

                "Gá»­i tháº§y, ngÆ°á»i Ä‘Ã£ dáº¡y em khÃ´ng chá»‰ kiáº¿n thá»©c mÃ  cÃ²n cÃ¡ch lÃ m ngÆ°á»i. ChÃºc tháº§y ngÃ y NhÃ  giÃ¡o 20/11 tháº­t Ã½ nghÄ©a, luÃ´n máº¡nh khá»e vÃ  thÃ nh cÃ´ng! Em sáº½ luÃ´n nhá»› Æ¡n tháº§y! ğŸ¯âœ¨",

                "NhÃ¢n ngÃ y 20/11, em chÃºc tháº§y luÃ´n giá»¯ Ä‘Æ°á»£c ngá»n lá»­a Ä‘am mÃª vá»›i nghá», sá»©c khá»e dá»“i dÃ o vÃ  gáº·p nhiá»u may máº¯n. Tháº§y lÃ  ngÆ°á»i tháº§y tuyá»‡t vá»i nháº¥t trong lÃ²ng em! ğŸ”¥ğŸŒŸ",

                "ChÃºc má»«ng ngÃ y NhÃ  giÃ¡o Viá»‡t Nam! Tháº§y khÃ´ng chá»‰ truyá»n Ä‘áº¡t tri thá»©c mÃ  cÃ²n truyá»n cáº£m há»©ng cho em má»—i ngÃ y. ChÃºc tháº§y luÃ´n háº¡nh phÃºc vÃ  thÃ nh cÃ´ng rá»±c rá»¡! ğŸŒˆğŸ’–"
            ];

            // Lá»i chÃºc cho cÃ´ giÃ¡o (ná»¯)
            const femaleWishes = [
                "NhÃ¢n ngÃ y NhÃ  giÃ¡o Viá»‡t Nam 20/11, em xin gá»­i Ä‘áº¿n cÃ´ lá»i chÃºc sá»©c khá»e dá»“i dÃ o, háº¡nh phÃºc an lÃ nh. Cáº£m Æ¡n cÃ´ Ä‘Ã£ luÃ´n táº­n tÃ¢m truyá»n Ä‘áº¡t kiáº¿n thá»©c vÃ  yÃªu thÆ°Æ¡ng há»c trÃ²! ğŸŒ¹âœ¨",
                
                "KÃ­nh chÃºc cÃ´ ngÃ y 20/11 tháº­t nhiá»u niá»m vui vÃ  háº¡nh phÃºc! Nhá»¯ng bÃ i giáº£ng cá»§a cÃ´ khÃ´ng chá»‰ lÃ  tri thá»©c mÃ  cÃ²n lÃ  nguá»“n cáº£m há»©ng cho em má»—i ngÃ y. CÃ´ mÃ£i lÃ  ngÆ°á»i tháº§y tuyá»‡t vá»i nháº¥t! ğŸ“šğŸ’–",
                
                "ChÃºc cÃ´ luÃ´n trÃ n Ä‘áº§y nÄƒng lÆ°á»£ng, sá»©c khá»e dá»“i dÃ o vÃ  gáº·t hÃ¡i nhiá»u thÃ nh cÃ´ng trong sá»± nghiá»‡p cao quÃ½. Em biáº¿t Æ¡n vÃ¬ Ä‘Ã£ Ä‘Æ°á»£c lÃ m há»c trÃ² cá»§a cÃ´! ğŸ“ğŸŒŸ",
                
                "Gá»­i cÃ´ ngÆ°á»i em kÃ­nh yÃªu, chÃºc má»«ng ngÃ y NhÃ  giÃ¡o Viá»‡t Nam! Cáº£m Æ¡n cÃ´ Ä‘Ã£ dÃ nh cáº£ thanh xuÃ¢n Ä‘á»ƒ hun Ä‘Ãºc tri thá»©c vÃ  tÃ¢m há»“n cho tháº¿ há»‡ há»c trÃ². CÃ´ lÃ  niá»m tá»± hÃ o cá»§a chÃºng em! ğŸ†ğŸ’«",
                
                "NhÃ¢n dá»‹p 20/11, em chÃºc cÃ´ luÃ´n vui váº», máº¡nh khá»e vÃ  thÃ nh cÃ´ng rá»±c rá»¡! Nhá»¯ng lá»i dáº¡y cá»§a cÃ´ sáº½ mÃ£i lÃ  hÃ nh trang quÃ½ giÃ¡ trÃªn con Ä‘Æ°á»ng trÆ°á»Ÿng thÃ nh cá»§a em. YÃªu cÃ´ nhiá»u láº¯m! ğŸ’ğŸŒˆ",
                
                "ChÃºc cÃ´ má»™t ngÃ y 20/11 tháº­t Ã½ nghÄ©a! CÃ´ khÃ´ng chá»‰ lÃ  ngÆ°á»i tháº§y mÃ  cÃ²n lÃ  ngÆ°á»i báº¡n, ngÆ°á»i Ä‘á»‹nh hÆ°á»›ng cho cuá»™c Ä‘á»i em. Em sáº½ luÃ´n nhá»› Æ¡n vÃ  tá»± hÃ o vá» cÃ´! ğŸŒ¸âœ¨",
                
                "KÃ­nh gá»­i cÃ´, nhÃ¢n ngÃ y NhÃ  giÃ¡o Viá»‡t Nam, em chÃºc cÃ´ luÃ´n tÆ°Æ¡i tráº», háº¡nh phÃºc vÃ  thÃ nh Ä‘áº¡t! Cáº£m Æ¡n cÃ´ Ä‘Ã£ luÃ´n kiÃªn nháº«n, táº­n tÃ¬nh vÃ  yÃªu thÆ°Æ¡ng chÃºng em! ğŸŠğŸ’",
                
                "20/11 - ngÃ y Ä‘á»ƒ em Ä‘Æ°á»£c bÃ y tá» lÃ²ng biáº¿t Æ¡n sÃ¢u sáº¯c Ä‘áº¿n cÃ´. ChÃºc cÃ´ sá»©c khá»e, bÃ¬nh an vÃ  luÃ´n lÃ  ngá»n Ä‘Ã¨n soi Ä‘Æ°á»ng cho biáº¿t bao tháº¿ há»‡ há»c trÃ²! ğŸ•¯ï¸ğŸŒŸ",

                "CÃ´ Æ¡i, ngÃ y 20/11 nÃ y em chÃºc cÃ´ luÃ´n tÆ°Æ¡i tráº» nhÆ° ngÃ y nÃ o, nhiá»‡t huyáº¿t vá»›i nghá» vÃ  háº¡nh phÃºc bÃªn gia Ä‘Ã¬nh. Cáº£m Æ¡n cÃ´ Ä‘Ã£ lÃ  Ã¡nh sÃ¡ng dáº«n Ä‘Æ°á»ng cho chÃºng em! ğŸŒºğŸ’•",

                "Gá»­i cÃ´, ngÆ°á»i Ä‘Ã£ dáº¡y em khÃ´ng chá»‰ kiáº¿n thá»©c mÃ  cÃ²n cÃ¡ch lÃ m ngÆ°á»i. ChÃºc cÃ´ ngÃ y NhÃ  giÃ¡o 20/11 tháº­t Ã½ nghÄ©a, luÃ´n máº¡nh khá»e vÃ  thÃ nh cÃ´ng! Em sáº½ luÃ´n nhá»› Æ¡n cÃ´! ğŸ¯âœ¨",

                "NhÃ¢n ngÃ y 20/11, em chÃºc cÃ´ luÃ´n giá»¯ Ä‘Æ°á»£c ngá»n lá»­a Ä‘am mÃª vá»›i nghá», sá»©c khá»e dá»“i dÃ o vÃ  gáº·p nhiá»u may máº¯n. CÃ´ lÃ  ngÆ°á»i tháº§y tuyá»‡t vá»i nháº¥t trong lÃ²ng em! ğŸ”¥ğŸŒŸ",

                "ChÃºc má»«ng ngÃ y NhÃ  giÃ¡o Viá»‡t Nam! CÃ´ khÃ´ng chá»‰ truyá»n Ä‘áº¡t tri thá»©c mÃ  cÃ²n truyá»n cáº£m há»©ng cho em má»—i ngÃ y. ChÃºc cÃ´ luÃ´n háº¡nh phÃºc vÃ  thÃ nh cÃ´ng rá»±c rá»¡! ğŸŒˆğŸ’–"
            ];

            // HÃ m táº¡o hash tá»« tÃªn
            function hashCode(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash);
            }

            // HÃ m random cÃ³ seed
            function getRandomWishIndex(name, wishCount) {
                const timestamp = Math.floor(Date.now() / 60000);
                const nameHash = hashCode(name.toLowerCase().trim());
                const seed = nameHash + timestamp;
                const x = Math.sin(seed) * 10000;
                const random = x - Math.floor(x);
                return Math.floor(random * wishCount);
            }

            // Láº¥y lá»i chÃºc unique
            function getUniqueWish(name, gender) {
                const wishes = gender === 'male' ? maleWishes : femaleWishes;
                const storageKey = 'wishHistory';
                let history = JSON.parse(localStorage.getItem(storageKey) || '[]');
                
                if (history.length > 5) {
                    history = history.slice(-5);
                }

                let wishIndex;
                let attempts = 0;
                const maxAttempts = 20;

                do {
                    wishIndex = getRandomWishIndex(name + attempts, wishes.length);
                    attempts++;
                } while (history.includes(wishIndex) && attempts < maxAttempts);

                if (attempts >= maxAttempts) {
                    wishIndex = Math.floor(Math.random() * wishes.length);
                }

                history.push(wishIndex);
                localStorage.setItem(storageKey, JSON.stringify(history));

                return wishes[wishIndex];
            }

            function createFallingIcon() {
                const icon = document.createElement('div');
                icon.classList.add('falling-icon');
                icon.innerHTML = icons[Math.floor(Math.random() * icons.length)];
                icon.style.left = Math.random() * 100 + 'vw';
                icon.style.fontSize = Math.random() * 20 + 15 + 'px';
                icon.style.animationDuration = Math.random() * 5 + 5 + 's';
                icon.style.animationDelay = Math.random() * 2 + 's';
                iconContainer.appendChild(icon);
                setTimeout(() => icon.remove(), 10000);
            }

            setInterval(createFallingIcon, 250);

            function showWish() {
                const name = nameInput.value.trim();
                if (name === "") {
                    alert("Tháº§y/CÃ´ Æ¡i, nháº­p tÃªn trÆ°á»›c Ä‘Ã£ nha ğŸ’");
                    return;
                }
                
                // Nháº­n diá»‡n giá»›i tÃ­nh
                const gender = detectGender(name);
                
                // Láº¥y lá»i chÃºc phÃ¹ há»£p
                const randomWish = getUniqueWish(name, gender);
                
                // Hiá»ƒn thá»‹ tÃªn vá»›i xÆ°ng hÃ´ phÃ¹ há»£p
                const title = gender === 'male' ? 'Tháº§y' : (gender === 'female' ? 'CÃ´' : 'Tháº§y/CÃ´');
                
                recipientName.textContent = `${title} ${name}`;
                wishMessage.textContent = randomWish;
                promptContainer.style.display = 'none';
                card.style.display = 'block';
            }

            function goBack() {
                card.style.display = 'none';
                promptContainer.style.display = 'block';
                nameInput.value = '';
                nameInput.focus();
            }

            submitButton.addEventListener('click', showWish);
            backButton.addEventListener('click', goBack);
            nameInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') showWish();
            });
        });
    </script>

</body>
</html>
